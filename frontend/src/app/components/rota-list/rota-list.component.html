<div class="rota-list-container">
  <div class="page-header">
    <div>
      <h2>ğŸ“‹ ROTA / Timesheets</h2>
      <p class="subtitle">View employee schedules and timings</p>
    </div>
    <button class="btn btn-primary" (click)="uploadNewRota()" *ngIf="isAdmin">
      ğŸ“¤ Upload New ROTA
    </button>
  </div>

  <div class="content-layout">
    <!-- Sidebar - ROTA List -->
    <div class="sidebar">
      <h3>Available ROTAs</h3>

      <div *ngIf="loading" class="loading-state">
        <div class="spinner"></div>
        <p>Loading ROTAs...</p>
      </div>

      <div *ngIf="!loading && rotas.length === 0" class="empty-state">
        <p>ğŸ“­ No ROTAs available</p>
        <button class="btn btn-primary btn-sm" (click)="uploadNewRota()" *ngIf="isAdmin">
          Upload First ROTA
        </button>
      </div>

      <div class="rota-list" *ngIf="!loading">
        <div
          *ngFor="let rota of rotas"
          class="rota-item"
          [class.active]="selectedRota?.id === rota.id"
          (click)="viewRota(rota)"
        >
          <div class="rota-header">
            <span class="rota-hotel">ğŸ¨ {{ rota.hotelName }}</span>
            <div class="rota-actions">
              <span class="rota-badge">{{ rota.totalEmployees }} emp</span>
              <button
                *ngIf="isAdmin"
                class="btn-delete-rota"
                (click)="deleteRota(rota, $event)"
                title="Delete ROTA">
                ğŸ—‘ï¸
              </button>
            </div>
          </div>
          <div class="rota-department">{{ rota.department }}</div>
          <div class="rota-dates">
            {{ formatDate(rota.startDate) }} - {{ formatDate(rota.endDate) }}
          </div>
          <div class="rota-meta">
            <small>Uploaded by {{ rota.uploadedByName }}</small>
          </div>
        </div>
      </div>

      <!-- Pagination Controls for ROTA List -->
      <div class="pagination-container" *ngIf="usePagination && totalPages > 1">
        <div class="pagination-info">
          <span>Page {{ currentPage + 1 }} of {{ totalPages }}</span>
          <select class="page-size-select" [value]="pageSize" (change)="onPageSizeChange(+$any($event.target).value)">
            <option value="5">5 per page</option>
            <option value="10">10 per page</option>
            <option value="25">25 per page</option>
            <option value="50">50 per page</option>
          </select>
        </div>
        <div class="pagination-controls">
          <button 
            class="pagination-btn"
            [disabled]="currentPage === 0"
            (click)="onPageChange(0)"
            title="First Page">
            Â«Â«
          </button>
          <button 
            class="pagination-btn"
            [disabled]="currentPage === 0"
            (click)="onPageChange(currentPage - 1)"
            title="Previous Page">
            â€¹
          </button>
          <button 
            *ngFor="let pageNum of pageNumbers"
            class="pagination-btn"
            [class.active]="pageNum === currentPage"
            (click)="onPageChange(pageNum)">
            {{ pageNum + 1 }}
          </button>
          <button 
            class="pagination-btn"
            [disabled]="currentPage >= totalPages - 1"
            (click)="onPageChange(currentPage + 1)"
            title="Next Page">
            â€º
          </button>
          <button 
            class="pagination-btn"
            [disabled]="currentPage >= totalPages - 1"
            (click)="onPageChange(totalPages - 1)"
            title="Last Page">
            Â»Â»
          </button>
        </div>
      </div>
    </div>

    <!-- Main Content - Schedule Table -->
    <div class="main-content">
      <div *ngIf="!selectedRota" class="empty-selection">
        <div class="empty-icon">ğŸ“…</div>
        <h3>Select a ROTA to view schedules</h3>
        <p>Choose a ROTA from the list on the left</p>
      </div>

      <div *ngIf="selectedRota" class="schedule-view">
        <div class="schedule-header">
          <div>
            <h3>{{ selectedRota.hotelName }} - {{ selectedRota.department }}</h3>
            <p class="schedule-period">
              {{ formatDate(selectedRota.startDate) }} to {{ formatDate(selectedRota.endDate) }}
            </p>
          </div>
          <div class="schedule-info">
            <span class="info-badge">{{ selectedRota.totalEmployees }} Employees</span>
          </div>
        </div>

        <div *ngIf="loadingSchedules" class="loading-state">
          <div class="spinner"></div>
          <p>Loading schedules...</p>
        </div>

        <div *ngIf="!loadingSchedules && schedules.length === 0" class="empty-state">
          <p>ğŸ“­ No schedules found for your team</p>
        </div>

        <div *ngIf="!loadingSchedules && schedules.length > 0" class="schedule-table-wrapper">
          <table class="schedule-table">
            <thead>
              <tr>
                <th class="employee-col">Employee</th>
                <th *ngFor="let date of scheduleDates" class="date-col">
                  <div class="date-header">
                    {{ formatDateWithDay(date) }}
                  </div>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let employee of schedules">
                <td class="employee-name">
                  <span class="name-badge">ğŸ‘¤ {{ employee.employeeName }}</span>
                </td>
                <td *ngFor="let date of scheduleDates" [ngClass]="getDutyClass(employee.schedules[date]?.duty || undefined)">
                  <div class="duty-cell">
                    <span class="duty-text">{{ employee.schedules[date]?.duty || '-' }}</span>
                    <span class="duty-time" *ngIf="employee.schedules[date]?.startTime && employee.schedules[date]?.endTime">
                      {{ employee.schedules[date]?.startTime }} - {{ employee.schedules[date]?.endTime }}
                    </span>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

